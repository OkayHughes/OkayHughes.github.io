<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://okayhughes.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://okayhughes.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2026-02-19T19:23:34+00:00</updated><id>https://okayhughes.github.io/feed.xml</id><title type="html">blank</title><subtitle>Owen K. Hughes is a Ph.D. student in Climate Science at the University of Michigan. </subtitle><entry><title type="html">What is this blog for?</title><link href="https://okayhughes.github.io/blog/2026/test/" rel="alternate" type="text/html" title="What is this blog for?"/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/test</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/test/"><![CDATA[<p>I’m a computational atmospheric scientist at the University of Michigan who is most interested in the computational fluid models called Dynamical Cores (Dycores) that lie at the heart of climate and weather models.</p> <p>I had the idea of putting my lab notebooks online for all to see. This isn’t a particularly useful idea in and of itself, but I could see a number of future projects that might be able to build on this.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        Burned all my notebooks!
        What good are notebooks?
        They won't help me survive. 
</code></pre></div></div>]]></content><author><name></name></author><category term="about"/><summary type="html"><![CDATA[A description of what this blog is]]></summary></entry><entry><title type="html">Moist Held Suarez with Topography</title><link href="https://okayhughes.github.io/blog/2026/mhs_with_topo/" rel="alternate" type="text/html" title="Moist Held Suarez with Topography"/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/mhs_with_topo</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/mhs_with_topo/"><![CDATA[<p>I’ll describe the process of using topography with idealized physics. In this document I’ll be explaining how to use the <code class="language-plaintext highlighter-rouge">landfrac</code> variable in the TJ16 compset to only apply surface fluxes over the ocean.</p> <p>The implicit update reads as \(\pder{q_a}{t} = \frac{C_E |\boldsymbol{v}_a| (q_{\textrm{sat}, a} - q_a)}{z_a}\) (with an analogous expression for \(T_a\)). It is updated with one step of a fixed-point iterationpatterned on backwards Euler. This reads as</p> \[\begin{align*} &amp;\phantom{\implies} \frac{q_a^{t+1} - q_a^t}{\Delta t} = \frac{C_E |\boldsymbol{v}_a| (q_{\textrm{sat}, a} - q_a^{t+1})}{z_a} \\ &amp;\implies q_a^{t+1} - q_a^t = \frac{\Delta t C_E |\boldsymbol{v}_a| q_{\textrm{sat}, a}}{z_a} - \frac{\Delta t C_E |\boldsymbol{v}_a| q_a^{t+1}}{z_a} \\ &amp;\implies \left( \frac{\Delta t C_E |\boldsymbol{v}_a|}{z_a} + 1 \right)q_a^{t+1} = \frac{\Delta t C_E |\boldsymbol{v}_a| q_{\textrm{sat}, a}}{z_a} + q_a^t \\ &amp;\implies q_a^{t+1} = \frac{q_{\textrm{sat}, a} + \frac{\Delta t C_E |\boldsymbol{v}_a| }{z_a} }{ 1 + \frac{\Delta t C_E |\boldsymbol{v}_a|}{z_a}} \\ \end{align*}\] <p>So if we assume that the RHS of the continuous-time equation is scaled by \(C_{\textrm{landfrac}}\), then anywhere that a \(C_E\) appears, you also apply \(C_{\textrm{landfrac}}\).</p>]]></content><author><name></name></author><category term="idealized-testing"/><category term="intermediate-complexity"/><summary type="html"><![CDATA[How can we use topography with idealized physics?]]></summary></entry><entry><title type="html">Explaining the weak laplacian in HOMME/CAM-SE</title><link href="https://okayhughes.github.io/blog/2026/vector_lap/" rel="alternate" type="text/html" title="Explaining the weak laplacian in HOMME/CAM-SE"/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/vector_lap</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/vector_lap/"><![CDATA[<h2 id="basic-principle">Basic principle:</h2> <p>Assume we’re calculating the Laplacian on a domain without boundary (true on sphere, ish)</p> <p>Recall A matrix \(A\) can be characterized by its action on an orthonormal basis, e.g. \(Ae_i = A_{:, i}\), \(e_i = (0, \ldots, \stackrel{i}{1}, ldots, 0)\), and that \(e_j^\top A e_i = A_{j,i}\) (i.e., we can extract the entries of a matrix by its action on “test vectors”.</p> <p>For this subroutine we recall that within an element, SE represents a scalar field as a sum \(u = \sum_{i,j=1}^{\textrm{npts}} a_{i,j} \phi_j(x)\phi_i(y)\), where \(\phi_k(x)\) is 1 at GLL point \(k\) and 0 at all other GLL points, and is a polynomial. <em>Spectral</em> derivatives are calculated by differentiating the \(\phi_k(x)\) <em>analytically</em> within the element, and then multiplying by a change of variables matrix (Dinv).</p> <p>To calculate a weak derivative, you multiply your desired function \(u\) by a “test function” \(v\) which you know to be nicer.</p> <p>Calculating the laplacian then looks like (assuming no boundary)</p> \[\begin{align*} \int (\nabla^2 u)v \intd{A} &amp;=\int (\nabla \cdot \nabla u) v {A} \\ &amp;= \stackrel{\textrm{boundary term}}{0} - \int \nabla v \cdot \nabla{u} \intd{A} \end{align*}\] <p>The weak formulation allows you to formulate a laplacian for \(u, v\) that have only first derivatives. Without performing element assembly (direct stiffness summation), \(\nabla u\) calculated by <code class="language-plaintext highlighter-rouge">gradient_sphere</code> will not be continuous at boundaries, and so \(\nabla \cdot \nabla u\) is not well defined. This is why <code class="language-plaintext highlighter-rouge">divergence_sphere_wk</code> is called.</p> <p>The intermediate code comes in three sections. The first conditional containing <code class="language-plaintext highlighter-rouge">grads(:,:,1) = grads(:,:,1)*mol_nu(:,:)</code> is for calculating molecular viscosity with a physically relevant nu. The second conditional containing <code class="language-plaintext highlighter-rouge">if (hypervis_power/=0 ) then</code> is for when hyperviscosity coefficients are determined at each grid point.</p> <p>The third conditional comes from an ad hoc redefinition of hyperviscosity that handles variable resolution. It is defined as \(\tilde{\nabla}^2u = \nabla \cdot V \nabla u\)</p> <p>There are several different methods for calculating \(V\) (none of which are physical, per se) but its purpose is to be able to input a constant value <code class="language-plaintext highlighter-rouge">nu_const</code> as, e.g., a namelist setting, and get reasonable hyperviscosity in a refined mesh.</p> <h2 id="notes-on-modifying-the-tensor">notes on modifying the tensor</h2> <p>Technically what we are computing is the Laplace-Beltrami operator, which in coordinates reads \(\nabla^2 f = \frac{1}{\sqrt{|g|}} \sum_{i}\sum_{j} \pder{}{x_i} \left(\sqrt{|g|} g^{i,j} \pder{f}{x_j} \right)\) , with \(g^{i,j}\) the inverse of the metric tensor.</p> <p>Let’s work using strong derivatives for the moment. Then let \(D^{-1}\) be the change-of-variables transformation as in the HOMME literature (contains cosine weighting). Let \(x_1, x_2\) be local coordinates in the reference element. Then \(\nabla^2 u = \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} D^{-\top}\left[D^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \right].\) Recall that $D^{-\top}D^{-1}$ is precisely $g^{i,j}$ in the above expression, as a change-of-variables with Jacobian \(D\) induces a metric \(D^\top D\). The quantity in the brackets is what comes from <code class="language-plaintext highlighter-rouge">gradient_sphere</code>. When the tensorVisc quantity is used, it then reads as</p> <p>Then \(\nabla^2 u = \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} D^{-\top}V\left[D^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \right].\)</p> <p>The construction of \(V\) (detailed in <code class="language-plaintext highlighter-rouge">cube_mod.F90</code>) then leads to \(\begin{align*} \nabla^2 u &amp;= \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} D^{-\top}D^\top E^{-\top}\Lambda^*\Lambda E^{-1} D\left[D^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \right] \\ &amp;= \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} E^{-\top}\Lambda^*\Lambda E^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \end{align*}\) where \(E\) diagonalizes \(D^\top D = E^\top \Lambda E\) and \(\Lambda^*\) is an ad-hoc diagonal matrix.</p> <h2 id="connection-between-laplacian-and-diffusion">Connection between laplacian and diffusion</h2> <p>In the momentum equation in Navier Stokes, the pressure gradient and diffusion terms both result from the Cauchy momentum equation \(\frac{\mathrm{D}\boldsymbol{v}}{\mathrm{D}t} = \frac{1}{\rho} \nabla \cdot \boldsymbol{\sigma}\), with the particular choice of stress tensor \(\boldsymbol{\sigma} = -p\boldsymbol{I} + \lambda \textrm{Tr}(\boldsymbol{\varepsilon})\boldsymbol{I} + 2\mu\boldsymbol{\varepsilon}\) with \(\boldsymbol{\varepsilon} = \frac{1}{2} \left(\nabla \boldsymbol{v} + (\nabla \boldsymbol{v}^\top) \right)\). The laplacian results from \(\nabla \cdot \mu \boldsymbol{\varepsilon} = \mu \nabla \cdot \nabla \boldsymbol{v}\).</p> <p>Here’s what we can conclude from this: the steps to design a reasonable tensor for your application should read something like this</p> <ul> <li>Transform to a tangent plane to the sphere using elem%lat in x-y coordinates (optional, but likely reduces mess when designing the stress tensor)</li> <li>Design a tensor \(\boldsymbol{V}(\Phi_s)\) that measures the “stress in the deformed configuration” (e.g. a Cauchy stress tensor)</li> <li>By using that tensor in laplacian_sphere_wk, your artificial diffusion will induce the time tendency necessary to relax the “deformed state” to a “reference state” with lower stress.</li> </ul> <p>The section on normal and shear stress in the <a href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor#Normal_and_shear_stresses">Cauchy stress tensor wikipedia page</a> will be helpful for defining this.</p> <h2 id="bigger-picture">bigger picture:</h2> <p>I’m not entirely sure that laplacian is the right tool to use here, as it seems to me it would be an artificial source/sink of moisture. That seems pretty undesirable to have within the dycore. If you’re looking to penalize diffusion of moisture against topographic gradients, my first thought would be to identify the source of that diffusion and eliminate it, rather than make an ad hoc tool to cancel it out. You could also introduce artificial flow into the wind that’s used by tracer advection to counteract it, which I think would cause minor thermodynamic inconsistency.</p>]]></content><author><name></name></author><category term="modeling-experts"/><category term="dycore-explainers"/><summary type="html"><![CDATA[The use of manifold-dependent tensors in the viscosity in SE the dynamical cores is tricky if you're most familiar with vector calculus. This post can help.]]></summary></entry><entry><title type="html">Split form advection is neat.</title><link href="https://okayhughes.github.io/blog/2026/eulerian_split_form_advection/" rel="alternate" type="text/html" title="Split form advection is neat."/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/eulerian_split_form_advection</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/eulerian_split_form_advection/"><![CDATA[<h2 id="background">Background</h2> <p>I recently started reading a <a href="https://epubs.siam.org/doi/10.1137/24M1692630">paper</a> that my first research mentor (Henry O. Jacobs) worked on about uncertainty propagation through dynamical systems, because it seems like the first step in the direction of doing more principled process-level UQ in earth system models. This paper have convinced me that earth system modelers might not know a really cool fact about tracer transport, and we could maybe make our lives easier by shifting to a split form (or half-density) formulation. In modeler’s terms, this should get us mass-conserving and positivity-preserving transport (possibly range-preserving) with no fixers, at least in the Eulerian frame.</p> <h2 id="how-does-split-form-skew-symmetric-transport-actually-work">How does split-form (skew-symmetric) transport actually work?</h2> <p>Let’s make some definitions: Let \(M\) be some manifold (probably always the sphere or the flat 3-torus). \(q \in L^1(M, \mathbb R)\) is a tracer mixing ratio <a href="#footnotes">[1]</a>, which, in analogy with the above paper, can actually be viewed as a scaled probability distribution, with \(\int q \intd{\mu} = b\) <a href="#footnotes">[3]</a> and \(\inf q &gt; 0\) <a href="#footnotes">[3]</a>. Let $X$ be a vector field on \(M\). Since we’re dealing with function-ish quantities, the lie derivative \(\mathcal{L}_X q\) <a href="#footnotes">[4]</a> can be associated with \(X \cdot \nabla q\), and so the continuity equation in this framing looks like \(\partial_t[q] + \mathcal{L}[q] = 0\), or, more familiarly: \(\pder{q}{t} + X \cdot \nabla q = 0\). Let \(\Phi_X^t\) be the map such that for \(x_0 \in M\), \(\Phi_x^t(x_0)\) is the flow map associated with $X$ (this is called \(X(t_0; x; t_1)\) in the Islet paper). Assuming that this map is nice enough to have an invertible differential \(\mathrm{D}(\Phi_X^t)^{-1}\) <a href="#footnotes">[5]</a>, the solution to the advection equation reads as \(\begin{align*} q_t(x) = \left|\det \mathrm{D}(\Phi_X^{t}(x))^{-1} \right| q_0((\Phi_X^t)^{-1}(x)). \end{align*}\)</p> <p>This is all slightly different notation for things you’ve probably already encountered. However, there’s this interesting fact that for reasonable (recall, non-negative) \(q\), \(\sqrt{q} \in L^2(M, \mathbb{R})\) <a href="#footnotes">[6]</a>. If we define $\mathcal{L}_X^{1/2}[h] = \frac{1}{2} (X \cdot \nabla h + \nabla \cdot h X)$ <a href="#footnotes">[7]</a>, then it turns out that if we let $h = \sqrt{q}$, in the equation $\partial_t h + \mathcal{L}_X^{1/2}[h] = 0$ (split-form transport!), then the square of $h(t)$ satisfies the transport equation. One can show by integration by parts (see the paper I mentioned above) that \(\begin{align*} \langle \mathcal{L}_x^{1/2}[\psi], \phi \rangle = -\langle \psi, \mathcal{L}_x^{1/2}[\phi] \rangle \end{align*}\). One observation of the original paper is that if you can discretize this transport operator such that your discrete operator is skew-symmetric, you can get spectral convergence with an operator that is inherently an isometry, and gives mass conservation and non-negativity by construction.</p> <h2 id="the-homme-stuff">The HOMME stuff:</h2> <p>Suppose for the moment that we evolve $\Delta \pi$ using split-form advection by solving the semi-discrete system $\partial_t \sqrt{\Delta \pi} + \mathcal{L}_\boldsymbol{u}^{1/2}[\sqrt{\Delta \pi}] = 0$ on the dynamics side of things. Let \(\overline{\Delta \pi}\) and $\bar{\boldsymbol{u}}$ be the suitable time-averaged quantities passed to tracer advection. For the moment, assume that $\nu_p = 0$ (I would like to work towards a world where $nu_p \ll \nu$, if only for code complexity reasons). Then we have the choice of whether to evolve $\sqrt{q}$ in a split-form way, or $\sqrt{q\Delta \pi}$, or $\sqrt{q} \Delta \pi$. Here I want to see if I can get tracer consistency (i.e. $q \equiv 1$ is preserved to machine precision), as well as some other things. What other things do I want to be satisified?</p> <ul> <li>$\int q_{\textrm{end}} \Delta \pi_{\textrm{end}} \intd{\mu} = \int q_{\textrm{begin}} \Delta \pi_{\textrm{begin}} \intd{\mu}$, where $\textrm{begin}$ and $\textrm{end}$ indicate that this might not be satisfied at intermediate steps.</li> <li>If $q_{\textrm{begin}} \equiv 1$, then $q_{\textrm{end}} \equiv 1$.</li> <li>$q_{\textrm{end}}(x) \geq 0$ at all nodes.</li> <li>$q_{\textrm{end}}$ is $C^0$. For the moment we are ignoring hyperviscosity for scalars.</li> </ul> <p>An interesting finding: let’s say we change dynamics so that $\sqrt{\Delta \pi}$ is prognostic, and we’re using split form transport for pseudodensity. Then in tracer transport, let’s say we advance $\sqrt{q}$. Then it turns out that \(\sqrt{q}\sqrt{\Delta \pi}\) is the product of two half-densities. The derivation property of Lie derivatives means that we can write</p> \[\begin{align*} 0 &amp;= \partial_t \sqrt{q\Delta \pi} + \mathcal{L}_{\mathbf{u}}[\sqrt{q \Delta \pi}] \\ &amp;= \sqrt{q}\partial_t \sqrt{\Delta \pi} + \sqrt{\Delta \pi} \partial_t \sqrt{q} + \sqrt{q} \mathcal{L}_{\mathbf{u}}[\sqrt{\Delta \pi}] + \sqrt{\Delta \pi} \mathcal{L}_{\mathbf{u}}[\sqrt{q}] \\ &amp;= \sqrt{q}[\partial_t \sqrt{\Delta \pi} + \mathcal{L}_{\mathbf{u}}[\sqrt{\Delta \pi}]] + \sqrt{\Delta \pi} [\partial_t \sqrt{q} + \mathcal{L}_{\mathbf{u}}[\sqrt{q}]] \\ \end{align*}\] <p>This means that if we structure our averages correctly such that our half-density advection constructs solutions \(\sqrt{\Delta \pi}_{\textrm{discrete}}\), \(\sqrt{q}_{\textrm{discrete}}\) such that the bracketed quantities are zero to machine precision, and those solutions have good positivity properties, then \(\partial_t q\Delta \pi + \mathcal{L}_{\mathbf{u}}[q \Delta \pi] = 0\) will also be satisfied to machine precision. So it seems we can get tracer consistency and sign-preservingness with no fixer, if we’re willing to incur the cost of spectrally truncating (under-integrating?) cross terms that occur by applying the skew-symmetric operator to \(\sqrt{q}\), \(\sqrt{\pi}\). It remains to be seen if this solution just basically flips the sign of spectral undershoots, and leaves overshoots unhandled (very possible). Toward that end, I don’t think this is necessarily even a good tracer scheme. But it has remarkably good properties for a scheme that’s this simple.</p> <p>Due to operator splitting (let’s work with forward Euler for the moment)</p> \[\begin{align*} \frac{\sqrt{q_{k+1}\Delta \pi_{k+1}} - \sqrt{q_{k}\Delta \pi_{k}}}{\Delta t} = \sqrt{q_{k+1}} \frac{\sqrt{\Delta \pi_{k+1}} - \sqrt{\Delta \pi_{k}}}{\Delta t} + \sqrt{\Delta \pi_{k+1}} \frac{\sqrt{q_{k+1}} - \sqrt{q_{k}}}{\Delta t}, \end{align*}\] <p>Plugging this in above and being more careful with time levels and letting $\partial_{\Delta t}$ be the forward Euler operator, we get \(\begin{align*} 0 &amp;= \sqrt{q_{k+1}}\partial_{\Delta t} \sqrt{\Delta \pi} + \sqrt{\Delta \pi_{k+1}} \partial_{\Delta t} \sqrt{q} + \sqrt{q_k} \mathcal{L}_{\mathbf{u}}[\sqrt{\Delta \pi_{k}}] + \sqrt{\Delta \pi_{k}} \mathcal{L}_{\mathbf{u}}[\sqrt{q_k}] \\ \end{align*}\)</p> <p>This explains why this isn’t a self-evident solution: to get this automatic stuff, we might need to use an implicit time step.</p> <p>It turns out that treating \(\sqrt{\Delta \pi q}\) is probably a better idea. Since all our time stepping methods are built from forward Euler (ish) and convex combinations, then if we are given $\sqrt{\Delta \pi_{k+1}}$ and $\sqrt{\Delta \pi_{k}}$ from dynamics (this is equivalent to the <code class="language-plaintext highlighter-rouge">vn0</code> averaging in HOMME). Then solving $\partial_{\Delta t} \sqrt{q \Delta \pi} + \mathcal{L}<em>{\mathbf{u}}^{1/2}[\sqrt{q \Delta \pi}] = 0 $ generates a solution that satisfies global mass conservation and non-negativity. This should actually be interpreted as $\partial</em>{\Delta t} \sqrt{q \Delta \pi} + \mathcal{L}_{\mathbf{u}}^{1/2}[\sqrt{q \Delta \pi}] = 0 $</p> <h3 id="footnotes"> Footnotes: </h3> <ol> <li>We’ll try to work weakly where we can so that q could be discontinuous. We’re not doing anything fancy so we can also just treat elements of \(L^p\) as some representative of the equivalence class.</li> <li>Technically this is an essential infimum, but this distinction is irrelevant. We’re doing tracer advection for the moment.</li> <li>\(\mu\) is a measure that correctly generalizes the notion of global integral. For HOMME, this will be the integral over the sphere, constructed with whatever generality you want.</li> <li>If you’re not a geometer (which I’m not either, lol), the Lie derivative is useful because it is characterized by the fact that the properties that characterize allow it to generalize the notion of directional derivative to basically any geometric object (vector, tensor, form, frame) for which the notion makes sense. It also doesn’t require a metric. A crucial observation of the structure preserving folks is that one can discretize this operator even in very general settings.</li> <li>This will be fine if you’re careful about how far $t$ is from your initial conditions, e.g., how you’re invoking Caratheodory’s or Peano’s theorems. I think. Also, the notation $(\Phi_X^t)^{-1}$ instead of $\Phi_X^{-t}$ is a helpful reminder that you have to be careful that you’re landing in the right (co)-tangent space when you’re using this map.</li> <li>Indeed, you can do a similar thing using the usual pattern for $L^p$ results, where $q^{\alpha}$ embeds in $L^{\alpha^{-1}}$. However, as with a lot of <em>applications</em> of $L^p$ results, the Hilbert space structure of the $\alpha=\frac{1}{2}$ case makes it much more useful. For our uses, the notion of skew-adjoint becomes available. Indeed, if you have some different value of $\alpha$, then the evolution under a vector field is governed by $\partial_t q + (1-\alpha) X \cdot \nabla q + \alpha \nabla \cdot qX = 0$. In particular, this means that the “advective” characterisation of transport means treating $q$ like a continuous function (a 0-density), and the “continuity” characterisation of transport treats $q$ as a 1-density (a density) in the technical sense. We’re just learning how to exploit the continuum in between.</li> <li>Here the original writeup deviates from immediately generalizing to a coordinate-free formulation, and it’s not worth my time to restore it. If you’re curious sort of what this looks like (and are willing to add a metric to your manifold), then the last two sections of <a href="https://en.wikipedia.org/wiki/Exterior_calculus_identities">this page</a> are very helpful to me.</li> <li>Importantly, \(\mathcal{L}_{X}^{1/2}\) isn’t actually a derivation. This makes sense as the quantity \(fg\) forms a 1-density.</li> </ol> <p>\(\begin{align*} \mathcal{L}_X^{1/2}(fg) &amp;= \frac{1}{2}\left[X \cdot \nabla[fg] + \nabla \cdot [fg X] \right] \\ &amp;= \frac{1}{2}\left[X \cdot [f\nabla[g] + g\nabla[f]] + f \nabla \cdot gX + gX \cdot [\nabla f] \right] \\ &amp;= \frac{1}{2}\left[f[X \cdot \nabla g + \nabla \cdot gX] + 2g X \cdot \nabla f \right] \\ \end{align*}\) and by going in the other order we find \(\begin{align*} \mathcal{L}_X^{1/2}(fg) &amp;= \frac{1}{2}\left[X \cdot \nabla[fg] + \nabla \cdot [fg X] \right] \\ &amp;= \frac{1}{2}\left[X \cdot [f\nabla[g] + g\nabla[f]] + g \nabla \cdot fX + fX \cdot [\nabla g] \right] \\ &amp;= \frac{1}{2}\left[g[X \cdot \nabla f + \nabla \cdot fX] + 2f X \cdot \nabla g \right] \\ \end{align*}\) so we can write \(\begin{align*} 2\mathcal{L}_X^{1/2}(fg) &amp;= f \mathcal{L}_{X}^{1/2}(g) + g \mathcal{L}_{X}^{1/2}(f) + g X \cdot \nabla f + f X \cdot \nabla g \\ &amp;= f \mathcal{L}_{X}^{1/2}(g) + g \mathcal{L}_{X}^{1/2}(f) + g X \cdot \nabla f + f X \cdot \nabla g \\ \end{align*}\)</p>]]></content><author><name></name></author><category term="modeling-experts"/><category term="math-of-dycores"/><summary type="html"><![CDATA[Are we thinking about tracer transport wrong? (Split form advection is neat.)]]></summary></entry></feed>