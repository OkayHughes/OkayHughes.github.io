<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://okayhughes.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://okayhughes.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2026-02-01T16:34:24+00:00</updated><id>https://okayhughes.github.io/feed.xml</id><title type="html">blank</title><subtitle>Owen K. Hughes is a Ph.D. student in Climate Science at the University of Michigan. </subtitle><entry><title type="html">What is this blog for?</title><link href="https://okayhughes.github.io/blog/2026/test/" rel="alternate" type="text/html" title="What is this blog for?"/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/test</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/test/"><![CDATA[<p>I’m a computational atmospheric scientist at the University of Michigan who is most interested in the computational fluid models called Dynamical Cores (Dycores) that lie at the heart of climate and weather models.</p> <p>I had the idea of putting my lab notebooks online for all to see. This isn’t a particularly useful idea in and of itself, but I could see a number of future projects that might be able to build on this.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        Burned all my notebooks!
        What good are notebooks?
        They won't help me survive. 
</code></pre></div></div>]]></content><author><name></name></author><category term="about"/><summary type="html"><![CDATA[A description of what this blog is]]></summary></entry><entry><title type="html">Moist Held Suarez with Topography</title><link href="https://okayhughes.github.io/blog/2026/mhs_with_topo/" rel="alternate" type="text/html" title="Moist Held Suarez with Topography"/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/mhs_with_topo</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/mhs_with_topo/"><![CDATA[<p>I’ll describe the process of using topography with idealized physics. In this document I’ll be explaining how to use the <code class="language-plaintext highlighter-rouge">landfrac</code> variable in the TJ16 compset to only apply surface fluxes over the ocean.</p> <p>The implicit update reads as \(\pder{q_a}{t} = \frac{C_E |\boldsymbol{v}_a| (q_{\textrm{sat}, a} - q_a)}{z_a}\) (with an analogous expression for \(T_a\)). It is updated with one step of a fixed-point iterationpatterned on backwards Euler. This reads as</p> \[\begin{align*} &amp;\phantom{\implies} \frac{q_a^{t+1} - q_a^t}{\Delta t} = \frac{C_E |\boldsymbol{v}_a| (q_{\textrm{sat}, a} - q_a^{t+1})}{z_a} \\ &amp;\implies q_a^{t+1} - q_a^t = \frac{\Delta t C_E |\boldsymbol{v}_a| q_{\textrm{sat}, a}}{z_a} - \frac{\Delta t C_E |\boldsymbol{v}_a| q_a^{t+1}}{z_a} \\ &amp;\implies \left( \frac{\Delta t C_E |\boldsymbol{v}_a|}{z_a} + 1 \right)q_a^{t+1} = \frac{\Delta t C_E |\boldsymbol{v}_a| q_{\textrm{sat}, a}}{z_a} + q_a^t \\ &amp;\implies q_a^{t+1} = \frac{q_{\textrm{sat}, a} + \frac{\Delta t C_E |\boldsymbol{v}_a| }{z_a} }{ 1 + \frac{\Delta t C_E |\boldsymbol{v}_a|}{z_a}} \\ \end{align*}\] <p>So if we assume that the RHS of the continuous-time equation is scaled by \(C_{\textrm{landfrac}}\), then anywhere that a \(C_E\) appears, you also apply \(C_{\textrm{landfrac}}\).</p>]]></content><author><name></name></author><category term="idealized-testing"/><category term="intermediate-complexity"/><summary type="html"><![CDATA[How can we use topography with idealized physics?]]></summary></entry><entry><title type="html">Explaining the weak laplacian in HOMME/CAM-SE</title><link href="https://okayhughes.github.io/blog/2026/vector_lap/" rel="alternate" type="text/html" title="Explaining the weak laplacian in HOMME/CAM-SE"/><published>2026-01-14T16:40:16+00:00</published><updated>2026-01-14T16:40:16+00:00</updated><id>https://okayhughes.github.io/blog/2026/vector_lap</id><content type="html" xml:base="https://okayhughes.github.io/blog/2026/vector_lap/"><![CDATA[<h2 id="basic-principle">Basic principle:</h2> <p>Assume we’re calculating the Laplacian on a domain without boundary (true on sphere, ish)</p> <p>Recall A matrix \(A\) can be characterized by its action on an orthonormal basis, e.g. \(Ae_i = A_{:, i}\), \(e_i = (0, \ldots, \stackrel{i}{1}, ldots, 0)\), and that \(e_j^\top A e_i = A_{j,i}\) (i.e., we can extract the entries of a matrix by its action on “test vectors”.</p> <p>For this subroutine we recall that within an element, SE represents a scalar field as a sum \(u = \sum_{i,j=1}^{\textrm{npts}} a_{i,j} \phi_j(x)\phi_i(y)\), where \(\phi_k(x)\) is 1 at GLL point \(k\) and 0 at all other GLL points, and is a polynomial. <em>Spectral</em> derivatives are calculated by differentiating the \(\phi_k(x)\) <em>analytically</em> within the element, and then multiplying by a change of variables matrix (Dinv).</p> <p>To calculate a weak derivative, you multiply your desired function \(u\) by a “test function” \(v\) which you know to be nicer.</p> <p>Calculating the laplacian then looks like (assuming no boundary)</p> \[\begin{align*} \int (\nabla^2 u)v \intd{A} &amp;=\int (\nabla \cdot \nabla u) v {A} \\ &amp;= \stackrel{\textrm{boundary term}}{0} - \int \nabla v \cdot \nabla{u} \intd{A} \end{align*}\] <p>The weak formulation allows you to formulate a laplacian for \(u, v\) that have only first derivatives. Without performing element assembly (direct stiffness summation), \(\nabla u\) calculated by <code class="language-plaintext highlighter-rouge">gradient_sphere</code> will not be continuous at boundaries, and so \(\nabla \cdot \nabla u\) is not well defined. This is why <code class="language-plaintext highlighter-rouge">divergence_sphere_wk</code> is called.</p> <p>The intermediate code comes in three sections. The first conditional containing <code class="language-plaintext highlighter-rouge">grads(:,:,1) = grads(:,:,1)*mol_nu(:,:)</code> is for calculating molecular viscosity with a physically relevant nu. The second conditional containing <code class="language-plaintext highlighter-rouge">if (hypervis_power/=0 ) then</code> is for when hyperviscosity coefficients are determined at each grid point.</p> <p>The third conditional comes from an ad hoc redefinition of hyperviscosity that handles variable resolution. It is defined as \(\tilde{\nabla}^2u = \nabla \cdot V \nabla u\)</p> <p>There are several different methods for calculating \(V\) (none of which are physical, per se) but its purpose is to be able to input a constant value <code class="language-plaintext highlighter-rouge">nu_const</code> as, e.g., a namelist setting, and get reasonable hyperviscosity in a refined mesh.</p> <h2 id="notes-on-modifying-the-tensor">notes on modifying the tensor</h2> <p>Technically what we are computing is the Laplace-Beltrami operator, which in coordinates reads \(\nabla^2 f = \frac{1}{\sqrt{|g|}} \sum_{i}\sum_{j} \pder{}{x_i} \left(\sqrt{|g|} g^{i,j} \pder{f}{x_j} \right)\) , with \(g^{i,j}\) the inverse of the metric tensor.</p> <p>Let’s work using strong derivatives for the moment. Then let \(D^{-1}\) be the change-of-variables transformation as in the HOMME literature (contains cosine weighting). Let \(x_1, x_2\) be local coordinates in the reference element. Then \(\nabla^2 u = \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} D^{-\top}\left[D^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \right].\) Recall that $D^{-\top}D^{-1}$ is precisely $g^{i,j}$ in the above expression, as a change-of-variables with Jacobian \(D\) induces a metric \(D^\top D\). The quantity in the brackets is what comes from <code class="language-plaintext highlighter-rouge">gradient_sphere</code>. When the tensorVisc quantity is used, it then reads as</p> <p>Then \(\nabla^2 u = \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} D^{-\top}V\left[D^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \right].\)</p> <p>The construction of \(V\) (detailed in <code class="language-plaintext highlighter-rouge">cube_mod.F90</code>) then leads to \(\begin{align*} \nabla^2 u &amp;= \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} D^{-\top}D^\top E^{-\top}\Lambda^*\Lambda E^{-1} D\left[D^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \right] \\ &amp;= \frac{1}{\sqrt{|D^{\top}D|}} \begin{pmatrix}\pder{}{x_1} \\ \pder{}{x_2}\end{pmatrix}^\top \sqrt{|D^{\top}D|} E^{-\top}\Lambda^*\Lambda E^{-1} \begin{pmatrix} \pder{f}{x_1} \\ \pder{f}{x_2} \end{pmatrix} \end{align*}\) where \(E\) diagonalizes \(D^\top D = E^\top \Lambda E\) and \(\Lambda^*\) is an ad-hoc diagonal matrix.</p> <h2 id="connection-between-laplacian-and-diffusion">Connection between laplacian and diffusion</h2> <p>In the momentum equation in Navier Stokes, the pressure gradient and diffusion terms both result from the Cauchy momentum equation \(\frac{\mathrm{D}\boldsymbol{v}}{\mathrm{D}t} = \frac{1}{\rho} \nabla \cdot \boldsymbol{\sigma}\), with the particular choice of stress tensor \(\boldsymbol{\sigma} = -p\boldsymbol{I} + \lambda \textrm{Tr}(\boldsymbol{\varepsilon})\boldsymbol{I} + 2\mu\boldsymbol{\varepsilon}\) with \(\boldsymbol{\varepsilon} = \frac{1}{2} \left(\nabla \boldsymbol{v} + (\nabla \boldsymbol{v}^\top) \right)\). The laplacian results from \(\nabla \cdot \mu \boldsymbol{\varepsilon} = \mu \nabla \cdot \nabla \boldsymbol{v}\).</p> <p>Here’s what we can conclude from this: the steps to design a reasonable tensor for your application should read something like this</p> <ul> <li>Transform to a tangent plane to the sphere using elem%lat in x-y coordinates (optional, but likely reduces mess when designing the stress tensor)</li> <li>Design a tensor \(\boldsymbol{V}(\Phi_s)\) that measures the “stress in the deformed configuration” (e.g. a Cauchy stress tensor)</li> <li>By using that tensor in laplacian_sphere_wk, your artificial diffusion will induce the time tendency necessary to relax the “deformed state” to a “reference state” with lower stress.</li> </ul> <p>The section on normal and shear stress in the <a href="https://en.wikipedia.org/wiki/Cauchy_stress_tensor#Normal_and_shear_stresses">Cauchy stress tensor wikipedia page</a> will be helpful for defining this.</p> <h2 id="bigger-picture">bigger picture:</h2> <p>I’m not entirely sure that laplacian is the right tool to use here, as it seems to me it would be an artificial source/sink of moisture. That seems pretty undesirable to have within the dycore. If you’re looking to penalize diffusion of moisture against topographic gradients, my first thought would be to identify the source of that diffusion and eliminate it, rather than make an ad hoc tool to cancel it out. You could also introduce artificial flow into the wind that’s used by tracer advection to counteract it, which I think would cause minor thermodynamic inconsistency.</p>]]></content><author><name></name></author><category term="modeling-experts"/><category term="dycore-explainers"/><summary type="html"><![CDATA[The use of manifold-dependent tensors in the viscosity in SE the dynamical cores is tricky if you're most familiar with vector calculus. This post can help.]]></summary></entry></feed>